{
	id: loa2_l5_castle_of_the_chaos_wizard__spire__setup_cutscene,
	controlledActions: {
		start_multiplexer: {
			startsWithCutscene: true,
			
			type: WAIT,
			executionDelayInSeconds: 0f,
			
			executes: [
                set_camera_position,
                turn_chaos_wizard_left,
                turn_lich_top_left,
                turn_lich_bottom_left,
                turn_laser_blaster_left,
                cultist_5_look_left,
                cultist_6_look_left,
                cultist_7_look_left,
                cultist_8_look_left,
                
                restore_player_health,
                forge_resurection_rune,
                
                chaos_wizard_speech,
                play_sound_effect_evil_laughter,
                
//                fast_setup,
			],
		},
		
		set_camera_position: {
            type: MOVE_CAMERA,
			targetPositionRelativeToUnitId: loa2_l5_castle_of_the_chaos_wizard__chaos_wizard,
			updatePositionRelativeToTarget: true,
			directlySetPosition: true,
            controlledUnitTarget: {x: -2.5, y: -2},
		},
		
		turn_chaos_wizard_left: {
            type: MOVE,
            
            controlledUnitId: loa2_l5_castle_of_the_chaos_wizard__chaos_wizard,
            controlledUnitTarget: {x: -0.1, y: 0},
            
            executes: [
                change_state_chaos_wizard_cast,
            ],
		},
		
		change_state_chaos_wizard_cast: {
            type: CHANGE_STATE,
            
            controlledUnitId: loa2_l5_castle_of_the_chaos_wizard__chaos_wizard,
			controlledUnitState: cast_loop_with_effect,
			
            executes: [
                change_state_chaos_wizard_idle,
            ],
		},
		
		change_state_chaos_wizard_idle: {
            type: CHANGE_STATE,
            
            executionDelayInSeconds: 2f,
            
            controlledUnitId: loa2_l5_castle_of_the_chaos_wizard__chaos_wizard,
            controlledUnitState: idle,
		},
		
		turn_lich_top_left: {
            type: MOVE,
            
            controlledUnitId: loa2_l5_castle_of_the_chaos_wizard_spire__lich__top,
            controlledUnitTarget: {x: -0.1, y: 0},
		},
		
		turn_lich_bottom_left: {
            type: MOVE,
            
            controlledUnitId: loa2_l5_castle_of_the_chaos_wizard_spire__lich__bottom,
            controlledUnitTarget: {x: -0.1, y: 0},
		},
		
		turn_laser_blaster_left: {
            type: MOVE,
            
            controlledUnitId: loa2_l5_castle_of_the_chaos_wizard_spire__laser_blaster_left,
            controlledUnitTarget: {x: -0.1, y: 0},
		},
		
		cultist_5_look_left: {
			type: MOVE,
            
            controlledUnitId: loa2_l5_castle_of_the_chaos_wizard_spire__cultist_worshiping_5,
			controlledUnitTarget: {x: -0.1, y: 0},
			
			executes: [
                change_state_cultist_5_worship,
			],
		},
		
		change_state_cultist_5_worship: {
            type: CHANGE_STATE,
			
            controlledUnitId: loa2_l5_castle_of_the_chaos_wizard_spire__cultist_worshiping_5,
			controlledUnitState: worship,
		},
		
		cultist_6_look_left: {
            type: MOVE,
            
            controlledUnitId: loa2_l5_castle_of_the_chaos_wizard_spire__cultist_worshiping_6,
            controlledUnitTarget: {x: -0.1, y: 0},
            
            executes: [
                change_state_cultist_6_worship,
			],
		},
		
		change_state_cultist_6_worship: {
            type: CHANGE_STATE,
            
            controlledUnitId: loa2_l5_castle_of_the_chaos_wizard_spire__cultist_worshiping_6,
            controlledUnitState: worship,
		},
		
		cultist_7_look_left: {
            type: MOVE,
            
            controlledUnitId: loa2_l5_castle_of_the_chaos_wizard_spire__cultist_worshiping_7,
            controlledUnitTarget: {x: -0.1, y: 0},
            
            executes: [
                change_state_cultist_7_worship,
			],
		},
		
		change_state_cultist_7_worship: {
            type: CHANGE_STATE,
            
            controlledUnitId: loa2_l5_castle_of_the_chaos_wizard_spire__cultist_worshiping_7,
            controlledUnitState: worship,
		},
		
		cultist_8_look_left: {
            type: MOVE,
            
            controlledUnitId: loa2_l5_castle_of_the_chaos_wizard_spire__cultist_worshiping_8,
            controlledUnitTarget: {x: -0.1, y: 0},
            
            executes: [
                change_state_cultist_8_worship,
			],
		},
		
		change_state_cultist_8_worship: {
            type: CHANGE_STATE,
            
            controlledUnitId: loa2_l5_castle_of_the_chaos_wizard_spire__cultist_worshiping_8,
            controlledUnitState: worship,
		},
		
		restore_player_health: {
            type: EVENT,
            
            event: {
                eventType: SET_HEALTH,
                floatValue: 100f,
			}
		},
		
		forge_resurection_rune: {
            type: EVENT,
            
            event: {
				eventType: SET_GLOBAL_CONDITION_VALUE,
				stringValue: "{key: rune_forged__kenaz, value: true}",
			},
		},
		
		chaos_wizard_speech: {
            type: SHOW_ON_SCREEN_TEXT,
			
			executionDelayInSeconds: 4f,
            
            executionParameters: {
                displayTextHeader: "Strange Chaos Wizard Guy",
                colorHeader: #850085,
                displayText: "The spire of my castle should be a suitable battlefield for our final duel!    \nBut I guess it could still use some more minions!!!                             \n*evil laughter*           ",
                showNextPageIcon: true,
                canBeSkipped: false,
			}
            
            waitForEventToFinish: true,
            
            executes: [
            	change_state_chaos_wizard_cast_2,
            ],
		},
		
		play_sound_effect_evil_laughter: {
			type: PLAY_SOUND,
			
			executionDelayInSeconds: 10.5f,
			
            soundEffectName: evil_laugh,
		},
		
		change_state_chaos_wizard_cast_2: {
            type: CHANGE_STATE,
            
            executionDelayInSeconds: 1f,
            
            controlledUnitId: loa2_l5_castle_of_the_chaos_wizard__chaos_wizard,
            controlledUnitState: cast_loop_with_effect,
            
            executes: [
                change_state_chaos_wizard_idle_2,
            	change_state_cultist_top_kneel,
            	change_state_cultist_bottom_kneel,
            	spawn_summoning_circle_effect,
            	spawn_magic_flame_circle,
            	spawn_magic_energy_line_bottom_left,
            	spawn_magic_energy_line_bottom_right,
            	spawn_magic_energy_line_top_left,
            	spawn_magic_energy_line_top_right,
            	
            	chaos_wizard_speech_2,
			],
		},
		
		change_state_chaos_wizard_idle_2: {
            type: CHANGE_STATE,
            
            executionDelayInSeconds: 9f,
            
            controlledUnitId: loa2_l5_castle_of_the_chaos_wizard__chaos_wizard,
            controlledUnitState: idle,
		},
		
		change_state_cultist_top_kneel: {
            type: CHANGE_STATE,
            
            executionDelayInSeconds: 2f,
            
            controlledUnitId: loa2_l5_castle_of_the_chaos_wizard_spire__lich__top,
            controlledUnitState: cultist_kneel_and_summon_lich,
		},
		
		change_state_cultist_bottom_kneel: {
            type: CHANGE_STATE,
            
            executionDelayInSeconds: 2f,
            
            controlledUnitId: loa2_l5_castle_of_the_chaos_wizard_spire__lich__bottom,
            controlledUnitState: cultist_kneel_and_summon_lich,
		},
		
		spawn_summoning_circle_effect: {
			type: EVENT,
			
			executionDelayInSeconds: 4.5f,
            
            event: {
                eventType: CUSTCENE_SPAWN_UNIT,
                stringValue: summoning_circle
			},
		},
		
		spawn_magic_flame_circle: {
			type: EVENT,
			
			executionDelayInSeconds: 8f,
            
            event: {
            	eventType: TRAVERSABLE_OBJECT_CHANGE_BODY_TO_SOLID_OBJECT,
            	intValue: 3,
            }
		},
		
		spawn_magic_energy_line_bottom_left: {
            type: EVENT,
            
            executionDelayInSeconds: 8f,
            
            event: {
            	eventType: DISPLAY_ANIMATION_GAME_OBJECT,
            	stringValue: loa2_l5_castle_of_the_chaos_wizard__spire__magic_energy_line_bottom_left,
            	booleanValue: true, // visible
			}
		},
		
		spawn_magic_energy_line_bottom_right: {
            type: EVENT,
            
            executionDelayInSeconds: 8f,
            
            event: {
            	eventType: DISPLAY_ANIMATION_GAME_OBJECT,
            	stringValue: loa2_l5_castle_of_the_chaos_wizard__spire__magic_energy_line_bottom_right,
            	booleanValue: true, // visible
			}
		},
		
		spawn_magic_energy_line_top_left: {
            type: EVENT,
            
            executionDelayInSeconds: 8f,
            
            event: {
            	eventType: DISPLAY_ANIMATION_GAME_OBJECT,
            	stringValue: loa2_l5_castle_of_the_chaos_wizard__spire__magic_energy_line_top_left,
            	booleanValue: true, // visible
			}
		},
		
		spawn_magic_energy_line_top_right: {
            type: EVENT,
            
            executionDelayInSeconds: 8f,
            
            event: {
            	eventType: DISPLAY_ANIMATION_GAME_OBJECT,
            	stringValue: loa2_l5_castle_of_the_chaos_wizard__spire__magic_energy_line_top_right,
            	booleanValue: true, // visible
			}
		},
		
		chaos_wizard_speech_2: {
            type: SHOW_ON_SCREEN_TEXT,
            
            executionDelayInSeconds: 13f,
            
            executionParameters: {
                displayTextHeader: "Strange Chaos Wizard Guy",
                colorHeader: #850085,
                displayText: "               \n               \nSo it begins...          ",
                showNextPageIcon: true,
                canBeSkipped: false,
			}
            
            waitForEventToFinish: true,
            
            executes: [
                start_boss_fight,
            ],
		},
		
		start_boss_fight: {
			type: EVENT,
			executionDelayInSeconds: 2f,
			
			event: {
				eventType: BOSS_ENEMY_SHOW,
			},
			
			executes: [
				chaos_wizard_speech_3,
			],
		},
		
		chaos_wizard_speech_3: {
			type: SHOW_ON_SCREEN_TEXT,
            
            executionDelayInSeconds: 5f,
            
            executionParameters: {
                displayTextHeader: "Strange Chaos Wizard Guy",
                colorHeader: #850085,
                displayText: "Hey wait!\nMy title doesn't fit the boss fight banner!\n                          \nGive me just a moment. I'll fix this in no time!          ",
                showNextPageIcon: true,
            }
            
            waitForEventToFinish: true,
            
            executes: [
                change_state_chaos_wizard_cast_3,
                chaos_wizard_keyboard_typing,
                change_chaos_wizard_name_in_boss_banner,
            ],
		},
		
		change_state_chaos_wizard_cast_3: {
            type: CHANGE_STATE,
            
            executionDelayInSeconds: 0.5f,
            
            controlledUnitId: loa2_l5_castle_of_the_chaos_wizard__chaos_wizard,
			controlledUnitState: cast_loop_with_effect,
			
            executes: [
                change_state_chaos_wizard_idle_3,
            ],
		},
		
		chaos_wizard_keyboard_typing: {
			type: PLAY_SOUND,
			
			executionDelayInSeconds: 1f,
			
            soundEffectName: keyboard_typing,
		},
		
		change_chaos_wizard_name_in_boss_banner: {
			type: EVENT,
			executionDelayInSeconds: 4f,
			
			event: {
				eventType: CONFIG_GENERATED_EVENT,
				stringValue: loa2_l5_castle_of_the_chaos_wizard__spire__change_chaos_wizard_name,
				intValue: 2, // second name option
			},
		},
		
		change_state_chaos_wizard_idle_3: {
            type: CHANGE_STATE,
            
            executionDelayInSeconds: 2.5f,
            
            controlledUnitId: loa2_l5_castle_of_the_chaos_wizard__chaos_wizard,
            controlledUnitState: idle,
            
            executes: [
                chaos_wizard_speech_4,
            ],
		},
		
		chaos_wizard_speech_4: {
			type: SHOW_ON_SCREEN_TEXT,
            
            executionDelayInSeconds: 5f,
            
            executionParameters: {
                displayTextHeader: "Strange Chaos Wizard Guy",
                colorHeader: #850085,
                displayText: "Damn!\nThe title is still too awesome for this stupid banner!                   \nNext time I'll use a higher screen resolution!          ",
                showNextPageIcon: true,
            }
            
            waitForEventToFinish: true,
            
            executes: [
                change_state_chaos_wizard_cast_4,
                chaos_wizard_keyboard_typing,
                change_chaos_wizard_name_in_boss_banner_2,
            ],
		},
		
		change_state_chaos_wizard_cast_4: {
            type: CHANGE_STATE,
            
            executionDelayInSeconds: 0.5f,
            
            controlledUnitId: loa2_l5_castle_of_the_chaos_wizard__chaos_wizard,
			controlledUnitState: cast_loop_with_effect,
			
            executes: [
                change_state_chaos_wizard_idle_4,
            ],
		},
		
		change_chaos_wizard_name_in_boss_banner_2: {
			type: EVENT,
			executionDelayInSeconds: 4f,
			
			event: {
				eventType: CONFIG_GENERATED_EVENT,
				stringValue: loa2_l5_castle_of_the_chaos_wizard__spire__change_chaos_wizard_name,
				intValue: 3, // third name option
			},
		},
		
		change_state_chaos_wizard_idle_4: {
            type: CHANGE_STATE,
            
            executionDelayInSeconds: 2.5f,
            
            controlledUnitId: loa2_l5_castle_of_the_chaos_wizard__chaos_wizard,
            controlledUnitState: idle,
            
            executes: [
                chaos_wizard_speech_5,
            ],
		},
		
		chaos_wizard_speech_5: {
            type: SHOW_ON_SCREEN_TEXT,
            
            executionDelayInSeconds: 5f,
            
            executionParameters: {
                displayTextHeader: "Strange Chaos Wizard Guy",
                colorHeader: #850085,
                displayText: "This should do!\n                      \nNow let's get this over with!          ",
                showNextPageIcon: true,
			}
            
            waitForEventToFinish: true,
            
            executes: [
            	stop_background_music,
                wait_before_starting_boss_fight,
			],
		},
		
		stop_background_music: {
            type: EVENT,
            
            executionDelayInSeconds: 1f,
            
            event: {
                eventType: STOP_BACKGROUND_MUSIC,
                booleanValue: true, // fade out
			}
			
			executes: [
				play_boss_fight_music,
			]
		},
		
		play_boss_fight_music: {
            type: EVENT,
            
            event: {
                eventType: ADD_BACKGROUND_MUSIC_TO_QUEUE, // add to queue is needed because of the fade out of the previous music
                stringValue: boss_fight,
                floatValue: 0f, // delay in seconds
                booleanValue: true,  // fade in
			}
		},
		
		wait_before_starting_boss_fight: {
            type: WAIT,
            
            executionDelayInSeconds: 5f,
            
            executes: [
                end,
			],
		},
		
		end: {
			type: WAIT,
			executionDelayInSeconds: 0f,
		}
		
		//********************************
		//*** faster setup for debuggin
		//********************************
		
		fast_setup: {
            type: WAIT,
            
            executes: [
            	__debug_change_state_cultist_top_kneel,
            	__debug_change_state_cultist_bottom_kneel,
            	__debug_spawn_magic_flame_circle,
            	__debug_spawn_magic_energy_line_bottom_left,
            	__debug_spawn_magic_energy_line_bottom_right,
            	__debug_spawn_magic_energy_line_top_left,
            	__debug_spawn_magic_energy_line_top_right,
            	__debug_start_boss_fight,
            	__debug_change_chaos_wizard_name_in_boss_banner_2,
            ],
		},
		
		__debug_change_state_cultist_top_kneel: {
            type: CHANGE_STATE,
            
            controlledUnitId: loa2_l5_castle_of_the_chaos_wizard_spire__lich__top,
            controlledUnitState: cultist_kneel_and_summon_lich,
		},
		
		__debug_change_state_cultist_bottom_kneel: {
            type: CHANGE_STATE,
            
            controlledUnitId: loa2_l5_castle_of_the_chaos_wizard_spire__lich__bottom,
            controlledUnitState: cultist_kneel_and_summon_lich,
		},
		
		__debug_spawn_magic_flame_circle: {
			type: EVENT,
			
            event: {
            	eventType: TRAVERSABLE_OBJECT_CHANGE_BODY_TO_SOLID_OBJECT,
            	intValue: 3,
            }
		},
		
		__debug_spawn_magic_energy_line_bottom_left: {
            type: EVENT,
            
            event: {
            	eventType: DISPLAY_ANIMATION_GAME_OBJECT,
            	stringValue: loa2_l5_castle_of_the_chaos_wizard__spire__magic_energy_line_bottom_left,
            	booleanValue: true, // visible
			}
		},
		
		__debug_spawn_magic_energy_line_bottom_right: {
            type: EVENT,
            
            event: {
            	eventType: DISPLAY_ANIMATION_GAME_OBJECT,
            	stringValue: loa2_l5_castle_of_the_chaos_wizard__spire__magic_energy_line_bottom_right,
            	booleanValue: true, // visible
			}
		},
		
		__debug_spawn_magic_energy_line_top_left: {
            type: EVENT,
            
            event: {
            	eventType: DISPLAY_ANIMATION_GAME_OBJECT,
            	stringValue: loa2_l5_castle_of_the_chaos_wizard__spire__magic_energy_line_top_left,
            	booleanValue: true, // visible
			}
		},
		
		__debug_spawn_magic_energy_line_top_right: {
            type: EVENT,
            
            event: {
            	eventType: DISPLAY_ANIMATION_GAME_OBJECT,
            	stringValue: loa2_l5_castle_of_the_chaos_wizard__spire__magic_energy_line_top_right,
            	booleanValue: true, // visible
			}
		},
		
		__debug_start_boss_fight: {
			type: EVENT,
			executionDelayInSeconds: 1f,
			
			event: {
				eventType: BOSS_ENEMY_SHOW,
			},
		},
		
		__debug_change_chaos_wizard_name_in_boss_banner_2: {
			type: EVENT,
			executionDelayInSeconds: 2f,
			
			event: {
				eventType: CONFIG_GENERATED_EVENT,
				stringValue: loa2_l5_castle_of_the_chaos_wizard__spire__change_chaos_wizard_name,
				intValue: 3, // third name option
			},
		},
	}
}